<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>dprot: /Users/davidmichaeli/Dropbox/Projects/communications/dprot_sim/dprot_sim/dprot.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">dprot
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Light weight master-slave communication for micro-controllers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4bbe2b792e8959be382eb1d30ab260e6.html">dprot_sim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dprot.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This layer is situated over the slip tranport layer.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="spec__types_8h_source.html">spec_types.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="slip_8h_source.html">slip.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="checking_8h_source.html">checking.h</a>&quot;</code><br/>
</div>
<p><a href="dprot_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab324e7aad11b46fd70724c8b67098878"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#ab324e7aad11b46fd70724c8b67098878">DPROT_MAX_MSG</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:ab324e7aad11b46fd70724c8b67098878"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines that maximal allowed message size.  <a href="#ab324e7aad11b46fd70724c8b67098878">More...</a><br/></td></tr>
<tr class="separator:ab324e7aad11b46fd70724c8b67098878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8665bf9f04a8b8e5fc3221943dc81a16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a8665bf9f04a8b8e5fc3221943dc81a16">DPROT_PTOT_SIZE</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:a8665bf9f04a8b8e5fc3221943dc81a16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total bytes taked by the protocol for header and footer of messages.  <a href="#a8665bf9f04a8b8e5fc3221943dc81a16">More...</a><br/></td></tr>
<tr class="separator:a8665bf9f04a8b8e5fc3221943dc81a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb61422b330bd4f9c2f52c714a9bb83e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#adb61422b330bd4f9c2f52c714a9bb83e">DPROT_MAX_PAYLOAD</a>&#160;&#160;&#160;(<a class="el" href="dprot_8h.html#ab324e7aad11b46fd70724c8b67098878">DPROT_MAX_MSG</a>-<a class="el" href="dprot_8h.html#a8665bf9f04a8b8e5fc3221943dc81a16">DPROT_PTOT_SIZE</a>)</td></tr>
<tr class="memdesc:adb61422b330bd4f9c2f52c714a9bb83e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The total neto size of a payload.  <a href="#adb61422b330bd4f9c2f52c714a9bb83e">More...</a><br/></td></tr>
<tr class="separator:adb61422b330bd4f9c2f52c714a9bb83e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1328a6a9ba3bb595a1191072c307840"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#af1328a6a9ba3bb595a1191072c307840">DPROT_CHECKING</a>(c, d)&#160;&#160;&#160;<a class="el" href="checking_8h.html#ac080cfc461d09729e6721572f468ad3c">crc8_add_byte</a>((c),(d))</td></tr>
<tr class="memdesc:af1328a6a9ba3bb595a1191072c307840"><td class="mdescLeft">&#160;</td><td class="mdescRight">The checking algorithm used by dProt.  <a href="#af1328a6a9ba3bb595a1191072c307840">More...</a><br/></td></tr>
<tr class="separator:af1328a6a9ba3bb595a1191072c307840"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb7364930d4544bcbdf1fbd9c9b36b0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#accb7364930d4544bcbdf1fbd9c9b36b0">DPROT_MASTER_NUM_RETRIES</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:accb7364930d4544bcbdf1fbd9c9b36b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of retries on communication.  <a href="#accb7364930d4544bcbdf1fbd9c9b36b0">More...</a><br/></td></tr>
<tr class="separator:accb7364930d4544bcbdf1fbd9c9b36b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a06fc87d81c62e9abb8790b6e5713c55b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br/>
&#160;&#160;<a class="el" href="dprot_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba92e39464217a87ca4f4903840dcefff3">DPROT_TYPE_DATA</a> = 0x10, 
<a class="el" href="dprot_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba6a4ca37b98ea5504c4c54482df85b8fa">DROPT_TYPE_ARP</a> = 0x20, 
<a class="el" href="dprot_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba35c2c8663dd6db5a5e5c2b29c5ef1a06">DPROT_TYPE_ACK</a> = 0x30, 
<a class="el" href="dprot_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba54ce384fbffd5d7068c15e0b3414644c">DPROT_TYPE_NACK</a> = 0x40, 
<br/>
&#160;&#160;<a class="el" href="dprot_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba27716243d666996cfa3dc6a81ec12408">DPROT_TYPE_SYNC</a> = 0xA0
<br/>
 }</td></tr>
<tr class="separator:a06fc87d81c62e9abb8790b6e5713c55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf764cbdea00d65edcd07bb9953ad2b7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br/>
&#160;&#160;<a class="el" href="dprot_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a3a8f0112ca2b95c17736fb766a153249">DPROT_NO_ERROR</a> = 0x00, 
<a class="el" href="dprot_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a6cc025157be18537ad4a3d589b6dc9ff">DPROT_FRAMING_ERROR</a> = 0x01, 
<a class="el" href="dprot_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a8fb033a5a143371245edf0572dfed6d1">DPROT_DATA_ERROR</a> = 0x02, 
<a class="el" href="dprot_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a7bef7dfe9a2180c6086189755c6fc068">DPROT_LOGICAL_ERROR</a> = 0x03, 
<br/>
&#160;&#160;<a class="el" href="dprot_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a518e568120add83eeb207b7094e1ddd1">DPROT_MSG_SIZE_ERROR</a> = 0x04, 
<a class="el" href="dprot_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a64f3ea2269bf0decb2e0dc9184218f3a">DPROT_ACK_ACCEPTED</a> = 0xA0, 
<a class="el" href="dprot_8h.html#adf764cbdea00d65edcd07bb9953ad2b7ad672871fd1e590d86a514d0695116f77">DPROT_NACK_ACCEPTED</a> = 0xB0
<br/>
 }</td></tr>
<tr class="separator:adf764cbdea00d65edcd07bb9953ad2b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a11d0af51980a64b65ad6180e0efd7fc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a11d0af51980a64b65ad6180e0efd7fc0">dprot_master_init_protocol</a> (<a class="el" href="spec__types_8h.html#a37f4bf12d02c5a8034ea7842fc44139e">fn_put_char</a> put_function, <a class="el" href="spec__types_8h.html#ace37bdc988d620cf5545d6be5c8df9a6">fn_get_char_to</a> get_function)</td></tr>
<tr class="memdesc:a11d0af51980a64b65ad6180e0efd7fc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing the master side protocol of the dProt.  <a href="#a11d0af51980a64b65ad6180e0efd7fc0">More...</a><br/></td></tr>
<tr class="separator:a11d0af51980a64b65ad6180e0efd7fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef09ce7327a2de0354f758044c0ce218"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#aef09ce7327a2de0354f758044c0ce218">dprot_master_send_ping</a> (void)</td></tr>
<tr class="memdesc:aef09ce7327a2de0354f758044c0ce218"><td class="mdescLeft">&#160;</td><td class="mdescRight">dProt master send ping message to the slave  <a href="#aef09ce7327a2de0354f758044c0ce218">More...</a><br/></td></tr>
<tr class="separator:aef09ce7327a2de0354f758044c0ce218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fe385c2f80d9312dae44952f99d62d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a4fe385c2f80d9312dae44952f99d62d9">dprot_master_send_sync</a> (void)</td></tr>
<tr class="memdesc:a4fe385c2f80d9312dae44952f99d62d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">dProt master send sync message to the slave  <a href="#a4fe385c2f80d9312dae44952f99d62d9">More...</a><br/></td></tr>
<tr class="separator:a4fe385c2f80d9312dae44952f99d62d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d459bd5ac67a744b72d63eae4f4b8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a56d459bd5ac67a744b72d63eae4f4b8e">dprot_master_send_data_msg</a> (<a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buffer, <a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> len)</td></tr>
<tr class="memdesc:a56d459bd5ac67a744b72d63eae4f4b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">dProt master send data to the slave  <a href="#a56d459bd5ac67a744b72d63eae4f4b8e">More...</a><br/></td></tr>
<tr class="separator:a56d459bd5ac67a744b72d63eae4f4b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a617f56a1395659cd976f4b6b17ac83f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a617f56a1395659cd976f4b6b17ac83f8">dprot_master_wait_for_ack_nack</a> (void)</td></tr>
<tr class="memdesc:a617f56a1395659cd976f4b6b17ac83f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">master node waiting for the ack/nack message from the slave  <a href="#a617f56a1395659cd976f4b6b17ac83f8">More...</a><br/></td></tr>
<tr class="separator:a617f56a1395659cd976f4b6b17ac83f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aa9db5d360ad0c94b2becc3825dd06e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a6aa9db5d360ad0c94b2becc3825dd06e">dprot_master_wait_for_data</a> (<a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buffer, <a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> max_len)</td></tr>
<tr class="memdesc:a6aa9db5d360ad0c94b2becc3825dd06e"><td class="mdescLeft">&#160;</td><td class="mdescRight">master node waiting a data message from the slave.  <a href="#a6aa9db5d360ad0c94b2becc3825dd06e">More...</a><br/></td></tr>
<tr class="separator:a6aa9db5d360ad0c94b2becc3825dd06e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a905d476e97295bb55becd22f2f333924"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a905d476e97295bb55becd22f2f333924">dprot_slave_init_protocol</a> (<a class="el" href="spec__types_8h.html#a37f4bf12d02c5a8034ea7842fc44139e">fn_put_char</a> put_function, <a class="el" href="spec__types_8h.html#ae27f995dac682449dbaccadf5e5f8f2f">fn_get_char</a> get_function)</td></tr>
<tr class="memdesc:a905d476e97295bb55becd22f2f333924"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing the slave side protocol of the dProt.  <a href="#a905d476e97295bb55becd22f2f333924">More...</a><br/></td></tr>
<tr class="separator:a905d476e97295bb55becd22f2f333924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d91e34fef0ad41e2e5b30b795eb3c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#ad4d91e34fef0ad41e2e5b30b795eb3c8">dprot_slave_wait_for_msg</a> (<a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buffer, <a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> max_len)</td></tr>
<tr class="memdesc:ad4d91e34fef0ad41e2e5b30b795eb3c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">dProt slave waits for data message. This function analyzes the received message types and automatically filters them (sends back arp responses and sync stuff) until a data message arrives. This message is returned to the higher layer. The input 'buffer' and 'max_len' take into account the additional 'type', 'length' and 'checking_byte' which accumulate to additional 3 bytes. That means that the maximum possible 'payload length' is 256-3=253 bytes per transaction.  <a href="#ad4d91e34fef0ad41e2e5b30b795eb3c8">More...</a><br/></td></tr>
<tr class="separator:ad4d91e34fef0ad41e2e5b30b795eb3c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217093cf6ad27ebbdf52941a386bb393"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a217093cf6ad27ebbdf52941a386bb393">dprot_slave_send_ack</a> (void)</td></tr>
<tr class="memdesc:a217093cf6ad27ebbdf52941a386bb393"><td class="mdescLeft">&#160;</td><td class="mdescRight">dProt slave sending ack to the master  <a href="#a217093cf6ad27ebbdf52941a386bb393">More...</a><br/></td></tr>
<tr class="separator:a217093cf6ad27ebbdf52941a386bb393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24cca4088e15cad41bada0051d1f3d60"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a24cca4088e15cad41bada0051d1f3d60">dprot_slave_send_nack</a> (void)</td></tr>
<tr class="memdesc:a24cca4088e15cad41bada0051d1f3d60"><td class="mdescLeft">&#160;</td><td class="mdescRight">dProt slave sends 'nack' to the master (message error)  <a href="#a24cca4088e15cad41bada0051d1f3d60">More...</a><br/></td></tr>
<tr class="separator:a24cca4088e15cad41bada0051d1f3d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e228c8d4ed029cff858fbf658740fda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dprot_8h.html#a4e228c8d4ed029cff858fbf658740fda">dprot_slave_send_data_msg</a> (<a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buffer, <a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> len)</td></tr>
<tr class="memdesc:a4e228c8d4ed029cff858fbf658740fda"><td class="mdescLeft">&#160;</td><td class="mdescRight">dProt slave send data to the master This function will be always conducted by the slave in order to send back data to the initiator (master)  <a href="#a4e228c8d4ed029cff858fbf658740fda">More...</a><br/></td></tr>
<tr class="separator:a4e228c8d4ed029cff858fbf658740fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This layer is situated over the slip tranport layer. </p>
<p>Its in charge of the error checking, ack/nack-ing, sync and logical checkings on the trasmitter and receiver.</p>
<p>Message structure:</p>
<table class="doxtable">
<tr>
<th>7bit </th><th>1bit </th><th>8bit </th><th>'length'-bytes </th><th>8bit </th></tr>
<tr>
<td>type </td><td>seq </td><td>length</td><td>d a t a ... </td><td>checking8 </td></tr>
</table>
<p>The maximal message length (type+seq+length+data+check) is 256 bytes. Longer messages have to be framed in higher layer. The checking8 byte is one of 'crc8'/'chs8'/ /'xor8' checksum methods (you choose) of 'type'+'length' +'data'. The sequencial parity will keep a track on the 'sequencial number' of single bit long. </p>

<p>Definition in file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="af1328a6a9ba3bb595a1191072c307840"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DPROT_CHECKING</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="checking_8h.html#ac080cfc461d09729e6721572f468ad3c">crc8_add_byte</a>((c),(d))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The checking algorithm used by dProt. </p>

<p>Definition at line <a class="el" href="dprot_8h_source.html#l00049">49</a> of file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>

</div>
</div>
<a class="anchor" id="accb7364930d4544bcbdf1fbd9c9b36b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DPROT_MASTER_NUM_RETRIES&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The number of retries on communication. </p>

<p>Definition at line <a class="el" href="dprot_8h_source.html#l00054">54</a> of file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab324e7aad11b46fd70724c8b67098878"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DPROT_MAX_MSG&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines that maximal allowed message size. </p>

<p>Definition at line <a class="el" href="dprot_8h_source.html#l00034">34</a> of file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>

</div>
</div>
<a class="anchor" id="adb61422b330bd4f9c2f52c714a9bb83e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DPROT_MAX_PAYLOAD&#160;&#160;&#160;(<a class="el" href="dprot_8h.html#ab324e7aad11b46fd70724c8b67098878">DPROT_MAX_MSG</a>-<a class="el" href="dprot_8h.html#a8665bf9f04a8b8e5fc3221943dc81a16">DPROT_PTOT_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The total neto size of a payload. </p>

<p>Definition at line <a class="el" href="dprot_8h_source.html#l00044">44</a> of file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8665bf9f04a8b8e5fc3221943dc81a16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DPROT_PTOT_SIZE&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total bytes taked by the protocol for header and footer of messages. </p>

<p>Definition at line <a class="el" href="dprot_8h_source.html#l00039">39</a> of file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>dProt protocol message types enumeration Different types of message types send by the dProt network layer. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba92e39464217a87ca4f4903840dcefff3"></a>DPROT_TYPE_DATA</em>&nbsp;</td><td class="fielddoc">
<p>Data message </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba6a4ca37b98ea5504c4c54482df85b8fa"></a>DROPT_TYPE_ARP</em>&nbsp;</td><td class="fielddoc">
<p>ARP like 'ping' message </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba35c2c8663dd6db5a5e5c2b29c5ef1a06"></a>DPROT_TYPE_ACK</em>&nbsp;</td><td class="fielddoc">
<p>Acknowledge signs that a message was accepted by the slave </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba54ce384fbffd5d7068c15e0b3414644c"></a>DPROT_TYPE_NACK</em>&nbsp;</td><td class="fielddoc">
<p>Not-Acknowledge - some data was received but it was corrupted </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba27716243d666996cfa3dc6a81ec12408"></a>DPROT_TYPE_SYNC</em>&nbsp;</td><td class="fielddoc">
<p>Future use for syncing transmitter to receiver (auto-baudrate) </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="dprot_8h_source.html#l00064">64</a> of file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>

</div>
</div>
<a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function return codes (errors/warnings/data) </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a3a8f0112ca2b95c17736fb766a153249"></a>DPROT_NO_ERROR</em>&nbsp;</td><td class="fielddoc">
<p>All was OK </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a6cc025157be18537ad4a3d589b6dc9ff"></a>DPROT_FRAMING_ERROR</em>&nbsp;</td><td class="fielddoc">
<p>The received data contained framing problem (mostly inconsistence with length) </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a8fb033a5a143371245edf0572dfed6d1"></a>DPROT_DATA_ERROR</em>&nbsp;</td><td class="fielddoc">
<p>The received message had data error - crc8/checksum8/xor8 mismatch </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a7bef7dfe9a2180c6086189755c6fc068"></a>DPROT_LOGICAL_ERROR</em>&nbsp;</td><td class="fielddoc">
<p>The received data contained logical error like msg-type inconsistence, lentgh problem </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a518e568120add83eeb207b7094e1ddd1"></a>DPROT_MSG_SIZE_ERROR</em>&nbsp;</td><td class="fielddoc">
<p>The received data had size problem </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7a64f3ea2269bf0decb2e0dc9184218f3a"></a>DPROT_ACK_ACCEPTED</em>&nbsp;</td><td class="fielddoc">
<p>Ack message was received </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="adf764cbdea00d65edcd07bb9953ad2b7ad672871fd1e590d86a514d0695116f77"></a>DPROT_NACK_ACCEPTED</em>&nbsp;</td><td class="fielddoc">
<p>Nack message was received </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="dprot_8h_source.html#l00077">77</a> of file <a class="el" href="dprot_8h_source.html">dprot.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a11d0af51980a64b65ad6180e0efd7fc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_master_init_protocol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#a37f4bf12d02c5a8034ea7842fc44139e">fn_put_char</a>&#160;</td>
          <td class="paramname"><em>put_function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#ace37bdc988d620cf5545d6be5c8df9a6">fn_get_char_to</a>&#160;</td>
          <td class="paramname"><em>get_function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializing the master side protocol of the dProt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">put_function</td><td>the 'putchar' function to be assigned to the lower layers </td></tr>
    <tr><td class="paramname">get_function</td><td>the 'getchar' function to be assigned to the lower layers</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>success (DPROT_NO_ERROR), error otherwise </dd></dl>

<p>Definition at line <a class="el" href="dprot__master_8c_source.html#l00007">7</a> of file <a class="el" href="dprot__master_8c_source.html">dprot_master.c</a>.</p>

</div>
</div>
<a class="anchor" id="a56d459bd5ac67a744b72d63eae4f4b8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_master_send_data_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dProt master send data to the slave </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pre-allocated</td><td>buffer to be sent to the slave </td></tr>
    <tr><td class="paramname">the</td><td>number of bytes of buffer to be sent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>operation result: </dd>
<dd>
DPROT_NO_ERROR - Success </dd>
<dd>
DPROT_MSG_SIZE_ERROR - the requested buffer is too big for a single transaction. </dd></dl>

<p>Definition at line <a class="el" href="dprot__master_8c_source.html#l00150">150</a> of file <a class="el" href="dprot__master_8c_source.html">dprot_master.c</a>.</p>

</div>
</div>
<a class="anchor" id="aef09ce7327a2de0354f758044c0ce218"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_master_send_ping </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dProt master send ping message to the slave </p>
<dl class="section return"><dt>Returns</dt><dd>success (DPROT_NO_ERROR), error otherwise </dd></dl>

<p>Definition at line <a class="el" href="dprot__master_8c_source.html#l00195">195</a> of file <a class="el" href="dprot__master_8c_source.html">dprot_master.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4fe385c2f80d9312dae44952f99d62d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_master_send_sync </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dProt master send sync message to the slave </p>
<dl class="section return"><dt>Returns</dt><dd>success (DPROT_NO_ERROR), error otherwise </dd></dl>

<p>Definition at line <a class="el" href="dprot__master_8c_source.html#l00226">226</a> of file <a class="el" href="dprot__master_8c_source.html">dprot_master.c</a>.</p>

</div>
</div>
<a class="anchor" id="a617f56a1395659cd976f4b6b17ac83f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_master_wait_for_ack_nack </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>master node waiting for the ack/nack message from the slave </p>
<dl class="section return"><dt>Returns</dt><dd>result: </dd>
<dd>
DPROT_ACK_ACCEPTED - ack was received </dd>
<dd>
DPROT_NACK_ACCEPTED - nack was received </dd>
<dd>
DPROT_DATA_ERROR - the crc/chs/xor didn't match or unexpected type of msg was received </dd></dl>

<p>Definition at line <a class="el" href="dprot__master_8c_source.html#l00088">88</a> of file <a class="el" href="dprot__master_8c_source.html">dprot_master.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6aa9db5d360ad0c94b2becc3825dd06e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_master_wait_for_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>max_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>master node waiting a data message from the slave. </p>
<p>It can happen adter the master intiated data request transactions. </p>
<dl class="section return"><dt>Returns</dt><dd>result: </dd>
<dd>
DPROT_NO_ERROR - Success  DPROT_MAX_PAYLOAD - data came corrupted - length is too big </dd>
<dd>
DPROT_DATA_ERROR - checking error </dd>
<dd>
DPROT_LOGICAL_ERROR - the incoming frame didn't contain data type of message </dd></dl>

<p>Definition at line <a class="el" href="dprot__master_8c_source.html#l00019">19</a> of file <a class="el" href="dprot__master_8c_source.html">dprot_master.c</a>.</p>

</div>
</div>
<a class="anchor" id="a905d476e97295bb55becd22f2f333924"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_slave_init_protocol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#a37f4bf12d02c5a8034ea7842fc44139e">fn_put_char</a>&#160;</td>
          <td class="paramname"><em>put_function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#ae27f995dac682449dbaccadf5e5f8f2f">fn_get_char</a>&#160;</td>
          <td class="paramname"><em>get_function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializing the slave side protocol of the dProt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">put_function</td><td>the 'putchar' function to be assigned to the lower layers </td></tr>
    <tr><td class="paramname">get_function</td><td>the 'getchar' function to be assigned to the lower layers</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>success (DPROT_NO_ERROR), error otherwise </dd></dl>

<p>Definition at line <a class="el" href="dprot__slave_8c_source.html#l00007">7</a> of file <a class="el" href="dprot__slave_8c_source.html">dprot_slave.c</a>.</p>

</div>
</div>
<a class="anchor" id="a217093cf6ad27ebbdf52941a386bb393"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_slave_send_ack </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dProt slave sending ack to the master </p>
<dl class="section return"><dt>Returns</dt><dd>success (DPROT_NO_ERROR), error otherwise </dd></dl>

<p>Definition at line <a class="el" href="dprot__slave_8c_source.html#l00132">132</a> of file <a class="el" href="dprot__slave_8c_source.html">dprot_slave.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4e228c8d4ed029cff858fbf658740fda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_slave_send_data_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dProt slave send data to the master This function will be always conducted by the slave in order to send back data to the initiator (master) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pre-allocated</td><td>buffer to be sent to the master </td></tr>
    <tr><td class="paramname">the</td><td>number of bytes of buffer to be sent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>operation result: </dd>
<dd>
DPROT_NO_ERROR - Success </dd>
<dd>
DPROT_MSG_SIZE_ERROR - the requested buffer is too big for a single transaction. </dd></dl>

<p>Definition at line <a class="el" href="dprot__slave_8c_source.html#l00099">99</a> of file <a class="el" href="dprot__slave_8c_source.html">dprot_slave.c</a>.</p>

</div>
</div>
<a class="anchor" id="a24cca4088e15cad41bada0051d1f3d60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_slave_send_nack </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dProt slave sends 'nack' to the master (message error) </p>
<dl class="section return"><dt>Returns</dt><dd>success (DPROT_NO_ERROR), error otherwise </dd></dl>

<p>Definition at line <a class="el" href="dprot__slave_8c_source.html#l00147">147</a> of file <a class="el" href="dprot__slave_8c_source.html">dprot_slave.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad4d91e34fef0ad41e2e5b30b795eb3c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> dprot_slave_wait_for_msg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spec__types_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>max_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dProt slave waits for data message. This function analyzes the received message types and automatically filters them (sends back arp responses and sync stuff) until a data message arrives. This message is returned to the higher layer. The input 'buffer' and 'max_len' take into account the additional 'type', 'length' and 'checking_byte' which accumulate to additional 3 bytes. That means that the maximum possible 'payload length' is 256-3=253 bytes per transaction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pre-allocated</td><td>buffer to store the rx elements </td></tr>
    <tr><td class="paramname">maximal</td><td>length of buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the result: </dd>
<dd>
DPROT_NO_ERROR (success) </dd>
<dd>
DPROT_FRAMING_ERROR (faming error occured) </dd>
<dd>
DPROT_DATA_ERROR (the crc/chs/xor didn't match) </dd>
<dd>
DPROT_LOGICAL_ERROR - sync/length or something else went wrong </dd></dl>

<p>Definition at line <a class="el" href="dprot__slave_8c_source.html#l00019">19</a> of file <a class="el" href="dprot__slave_8c_source.html">dprot_slave.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 2 2013 00:10:39 for dprot by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
